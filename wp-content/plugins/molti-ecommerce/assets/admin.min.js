var eti_retry_count=0;function eti_process_response(e){var t="",s=e.indexOf('{"success"');return-1!==s?(t=e.substring(s),t=JSON.parse(t)):console.log("No valid JSON in the reply. Retrying"),t}function eti_ajax_complete(s){if(void 0!==s){var e=sitepresser_obj.api_url+"&eti_ajax_action=import-"+s;jQuery.get(e,function(e){var t=eti_process_response(e);jQuery(".eti_import_feedback").addClass(s),!0===t.success?(jQuery(".eti_import_complete").html(t.feedback_html),"complete"===s?jQuery(document).trigger("eti_import_complete"):jQuery(document).trigger("eti_import_failed")):jQuery(".eti_import_complete").html("Something went wrong!"),jQuery(".eti_import_summary").slideDown(),window.scrollTo(0,0)})}}function eti_send_action_request(c,d,p,u,m){if("undefined"!=typeof eti_ajax_queue){if(void 0===d)d="";else d="&"+d;jQuery(".eti_import_feedback").append("<div class='"+p+"'><span class='item_name'>"+u+"</span><span class='eti_status'><img src='"+sitepresser_obj.ajax_loader_url+"' /></span><div class='eti_logs'></div></div>"),jQuery.ajax(sitepresser_obj.api_url+"&activate-multi=sp&eti_ajax_action="+c+d,{timeout:3e4,fail:function(e,t,s){jQuery(".eti_import_feedback ."+p+" .eti_status").addClass("failed").html("<span class='dashicons dashicons-dismiss'></span>"),eti_ajax_complete("failed")},error:function(e,t,s){var i="",a="";if("timeout"==t){if(eti_retry_count<3){var o="<h3>Oh no! Something went wrong...</h3><p>No response received from the server. Normally due to a timeout (where an import takes more than 30 or so seconds to run). Would you like to retry the same file or to move onto the next one (not recommended as ths may result in missing files on your new site)?</p>",r=" "+ ++eti_retry_count;if(i="<a onclick=\"jQuery('.eti_import_feedback ."+p+" .eti_logs').slideToggle();\"><span class='re'>0</span><span class='am'>1</span><span class='gr'>0</span><span class='dashicons dashicons-arrow-down-alt2'></span></a>","import-media-items"!==c&&"import-media-item"!==c||(o+='<p>As this is a media import, what might have happened is a time out due to image resizing. You can disable image resizing for this import using the button below. If you use this option we recommend using a plugin like "Regenerate Thumbnails" once the import completes.</p>',o+="<a class='eti_button' onclick='jQuery(\".eti_import_feedback ."+p+' .eti_logs").slideUp(); jQuery(".eti_import_feedback .'+p+' .eti_logs .eti_button").remove(); eti_send_action_request("'+c+'", ("'+d+'" + "&eti_skip_thumbs=1"), "'+p+'" + "R" + "'+eti_retry_count+'", "'+u+'" + "'+r+'", "'+m+"\")'>Retry (Disable thumbnails)</a>"),o+="<a class='eti_button' onclick='jQuery(\".eti_import_feedback ."+p+' .eti_logs").slideUp(); jQuery(".eti_import_feedback .'+p+' .eti_logs .eti_button").remove(); eti_send_action_request("'+c+'", "'+d+'", "'+p+'" + "R" + "'+eti_retry_count+'", "'+u+'" + "'+r+'", "'+m+"\")'>Retry Step</a>",void 0!==m){var _=Math.ceil(m/eti_ajax_queue.length*100)+"%";jQuery(".eti_current_progress span").text(_),jQuery(".eti_current_progress").css("width",_),void 0===eti_ajax_queue[m]?o+="<a class='eti_button' style=\"float: right;\" onclick='jQuery(\".eti_import_feedback ."+p+' .eti_logs").slideUp(); jQuery(".eti_import_feedback .'+p+' .eti_logs .eti_button").remove(); eti_ajax_complete("complete")\'>Skip Step</a>':o+="<a class='eti_button' style=\"float: right;\" onclick='jQuery(\".eti_import_feedback ."+p+' .eti_logs").slideUp(); jQuery(".eti_import_feedback .'+p+' .eti_logs .eti_button").remove(); '+eti_ajax_queue[m]+"()'>Skip Step</a>"}a="<div class='eti_log_item severity_med'>"+o+"</div>",jQuery(".eti_import_feedback ."+p+" .eti_logs").html(a).slideDown(),jQuery(".eti_import_feedback ."+p+" .eti_status").addClass("failed").html(i+"<span class='dashicons dashicons-bell'></span>")}}else jQuery(".eti_import_feedback ."+p+" .eti_status").addClass("failed").html("<span class='dashicons dashicons-dismiss'></span>"),eti_ajax_complete("failed")},success:function(e,t,s){var i=eti_process_response(e),a="",o="";if("object"==typeof i){var r=0,_=0,n=0;if(0<i.log.length&&(i.log.forEach(function(e){switch(e.severity){case"high":n++;break;case"med":_++;break;case"low":r++}o+="<div class='eti_log_item severity_"+e.severity+"'>"+e.msg+"</div>"}),jQuery(".eti_import_feedback ."+p+" .eti_logs").html(o)),a="<a onclick=\"jQuery('.eti_import_feedback ."+p+" .eti_logs').slideToggle();\"><span class='re'>"+n+"</span><span class='am'>"+_+"</span><span class='gr'>"+r+"</span><span class='dashicons dashicons-arrow-down-alt2'></span></a>",!0===i.success){if(jQuery(".eti_import_feedback ."+p+" .eti_status").addClass("complete").html(a+"<span class='dashicons dashicons-yes-alt'></span>"),void 0!==m){var l=Math.ceil(m/eti_ajax_queue.length*100)+"%";jQuery(".eti_current_progress span").text(l),jQuery(".eti_current_progress").css("width",l),void 0===eti_ajax_queue[m]?eti_ajax_complete("complete"):eti_ajax_queue[m]()}}else jQuery(".eti_import_feedback ."+p+" .eti_status").addClass("failed").html(a+"<span class='dashicons dashicons-dismiss'></span>"),eti_ajax_failed("failed")}else eti_retry_count<3?eti_send_action_request(c,d,p,u+" "+ ++eti_retry_count,m):(jQuery(".eti_import_feedback ."+p+" .eti_status").addClass("failed").html(a+"<span class='dashicons dashicons-dismiss'></span>"),eti_ajax_failed("failed"))}})}}